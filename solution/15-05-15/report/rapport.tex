\documentclass[a4paper, 12pt]{report}

\usepackage[utf8]{inputenc} 	% accents
\usepackage[T1]{fontenc}      	% caractères français
\usepackage{graphicx}		% images

\title{Projet INFO-H-303 : Villo!}
\author{Hereman Nicolas, Van Brande Rodrigue}
\date{24 avril 2015}

\begin{document}
\maketitle 

\section*{Diagramme entité-association} % Diagramme
	\includegraphics[scale=0.8]{entityassocdiagram.pdf}

\section*{Contraintes et hypothèses} %Contraintes

	\begin{itemize}
		\item La \textit{DateExpiration} d'un \textit{Abonné} doit être strictement supérieure à sa \textit{DateInscription}
		
		\item La \textit{DateDépart} d'un \textit{Trajet} doit être strictement supérieure à la \textit{DateInscription} de l'\textit{Abonné} qui le fait.
		
		\item La \textit{DateDépart} d'un \textit{Trajet} pot être strictement inférieure à la \textit{DateExpiration} de l'\textit{Utilisateur}.
		
		\item La \textit{DateDépart} d'un \textit{Trajet} doit être strictement inférieure à la \textit{DateExpiration} de l'\textit{Utilisateur} qui le fait.
		
		\item La \textit{DateRetour} d'un \textit{Trajet} doit être strictement supérieure à la \textit{DateDépart} de ce même \textit{Trajet}.
		
		\item La \textit{DateDépart} d'un \textit{Trajet} doit être strictement supérieure à la \textit{DateMiseEnService} du \textit{Villo} concerné.
		
		\item A l'instant \textit{DateRetour}, la \textit{Station} de retour d'un \textit{Trajet} doit contenir moins de \textit{Villos} que sa \textit{Capacité}. Le calcul du nombre de \textit{Villos} présents dans une \textit{Station} à l'aide de l'entité \textit{Trajet}.
		
		\item Un même \textit{Villo} ne peut pas concerner deux \textit{Trajets} en même temps.
		
		\item Un même \textit{Utilisateur} ne peut pas faire deux \textit{Trajets} en même temps.
		
		\item Un \textit{Trajet i} qui suit directement un autre \textit{Trajet j} pour un même \textit{Villo} doit avoir la même \textit{Station} de départ que la \textit{Station} d'arrivée du \textit{Trajet j}.
		
		\item Si un \textit{Trajet} n'a pas d'\textit{Utilisateur}, il n'a pas de \textit{Station} de départ et inversement.
		
		\item Si un \textit{Trajet} n'a ni \textit{Utilisateur} ni \textit{Station} de départ, sa \textit{DateDépart} est 0000/00/00 - 00:00:00
		
		\item Pour chaque \textit{Villo}, il n'y a qu'un \textit{Trajet} sans \textit{Utilisateur} et \textit{Station} de départ. Ni plus ni moins.
		\item Si un \textit{Trajet} n'a pas de \textit{Station} de retour, il n'a pas de \textit{DateRetour} et inversement.
		
		\item Pour chaque \textit{Villo},  il y a au maximum un \textit{Trajet} sans \textit{DateRetour} et \textit{Station} de retour.
		
		\item Si un \textit{Trajet} n'a pas de \textit{DateDépart}, il a une \textit{DateRetour}.
		
		\item Si un \textit{Trajet} n'a pas de \textit{DateRetour}, il a une \textit{DateDépart}.
		
	\end{itemize}

\section*{Traduction relationnelle} %Relation
	
	\begin{itemize}
	
		\item Utilisateur(\underline{UID},MotDePasse,DateExpiration,CarteDeCredit)
		
		\item Abonne( \underline{UID}, \underline{RFID}, Nom, Rue, Numéro, CodePostal, Ville, Téléphone, DateInscription)
		
		\begin{itemize}
			\item UID référence Utilisateur.UID
		\end{itemize}
		
		\item Station(\underline{SID}, Nom, \underline{Longitude, Latitude}, Capacité, BorneDePaiement)
		
		\item Villo(\underline{VID},DateMiseEnService,Modèle, EnEtat)
		
		\item Trajet(\underline{VID,DateDépart}, \textit{UID}, \textit{StationDépart}, \textit{DateRetour}, \textit{StationRetour})
		
		\begin{itemize}
			\item UID référence Utilisateur.UID
			\item VID référence Villo.VID
			\item StationDépart référence Station.SID
			\item StationRetour référence Station.SID
		\end{itemize}
		
	\end{itemize}
	
	\subsection*{Remarque}
	Un Utilisateur.UID n'existant pas dans Abonné.UID est un utilisateur temporaire

\section*{Justification} % Justification

On utilise une table \textit{Utilisateur} pour stocker leurs données. On a créé une table \textit{Abonné} afin des les différencier des utilisateurs \textit{Temporaire}. Comme l'héritage des table est totale et exclusive et que toutes les informations dont on a besoin pour ces derniers sont déjà dans la table \textit{Utilisateur}, ils n'ont pas besoin d'une table pour eux. Les utilisateurs temporaires seront ceux qui n'ont pas leurs \textit{UID} dans la table \textit{Abonné}.

Les \textit{Stations} et \textit{Villos} ont aussi droit à leur table pour qu'on y sauvegarde leurs données.

On sauvegarde aussi la liste des \textit{Trajets} dans une table. Le fait que l'\textit{Utilisateur} et la \textit{StationDépart} soit optionnel peut paraître illogique par rapport à la réalité. Mais cela se justifie par le fait que les \textit{Villo} doivent être placé une première fois. Comme on ne sauvegarde pas la \textit{Station} dans laquelle ils sont stockés, on se repère au \textit{Trajet} pour le savoir. On les place donc à l'aide de \textit{Trajet} sans \textit{Station} de départ et sans \textit{Utilisateur}. Les \textit{Trajets} sans \textit{Station} de retour et \textit{DateRetour} sont les \textit{Trajets} encore en cours.

\end{document}